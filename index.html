<html>
<head>
  <title>Project Tarnished Memory</title>
</head>
<body>
  <script src="https://cdn.jsdelivr.net/particle-api-js/5/particle.min.js"></script>
  <script>
    var particle = new Particle();

    fetch("local.settings.json")
    .then(
      (response) => {
        console.log('Fetch local settings')
        return response.json() 
      })
    .then(
      (json) => {
        console.log('Log in to Particle')
        return particle.login({username: json.username, password: json.password});
      })    
    .then(
      (data) => {
        console.log('Get event stream')
        var token = data.body.access_token;
        return particle.getEventStream({ deviceID: '2d0041000a47373336323231', name: 'deviceCount', auth: token });
      })
    .then(
      (stream) => {
        console.log('Listen for events');
        stream.on('event', function(event) {
          console.log("Event: ", event.data);
        });
      })
    .catch(
      (error) => {
        console.log('Error', error);
      })
  </script>
</body>
</html>